# Backend-Services-Celebrities
This repository has the needed code to get the celebrities information stored in the database and the celebrities that the user is following in his twitter account that matches the celebrities stored in the database.

The api exposes two end points.

- getallcelebrities: Returns a json object array, where each entry has the next properties
    - twitteraccount: Twitter account id,
    - name: Twitter account name
    - urlphotoprofile: Twitter photo profile,
    - id: Id generated by the firebase db,
    - match: false

- getcelebritiesbyusertoken
    - twitteraccount: Twitter account id,
    - name: Twitter account name
    - urlphotoprofile: Twitter photo profile,
    - id: Id generated by the firebase db,
    - match: true if the user is following the twitter account

## Parameters

The getallcelebrities end point does not require any parameters. Only it is required that the celebrities collection exists in the database.

The getcelebritiesbyusertoken requires a json object with the next schema.

schema_get_celebrities_by_token = {
    "usertwittertoken": "string",
    "usertwittersecret": "string",
    'required': ['usertwittertoken', 'usertwittersecret']
}


Where "usertwittertoken" and the "usertwittersecret" are part of a multitoken generated by twitter during
the OAuth 2.0 authentication.

## USAGE
Install the enviroment on the root of this repository

    pipenv install 

run the API

    pipenv run src/celebrities_api.py

This will make two services available at 

http://localhost/apis/getallcelebrities/1.0.0

and

http://localhost/apis/getcelebritiesbyusertoken/1.0.0

This endpoint will be used after the client (web client or device client) performed the OAuth 2.0 authentication.


### Use example:

Supposing that the firebase database stores the next celebrities: ["MileyCyrus", "Cristiano", "realDonaldTrump"] and the user is following to Miley Cirys and Donald Trump, then

When calling the "getallcelebrities" end point the next json object will be generated

    [
        {
            "twitteraccount": "MileyCyrus",
            "name": "Miley Ray Cyrus",
            "urlphotoprofile": "http://pbs.twimg.com/profile_images/1172578079757062144/vG6TDFAh_normal.jpg",
            "id": "00ByuxVlET5mi7UdtIAt",
            "match": false
        },
        {
            "twitteraccount": "Cristiano",
            "name": "Cristiano Ronaldo",
            "urlphotoprofile": "http://pbs.twimg.com/profile_images/1157313327867092993/a09TxL_1_normal.jpg",
            "id": "0kOUeblGlR6aflMFAXQ5",
            "match": false
        },
        {
            "twitteraccount": "realDonaldTrump",
            "name": "Donald J. Trump",
            "urlphotoprofile": "http://pbs.twimg.com/profile_images/874276197357596672/kUuht00m_normal.jpg",
            "id": "4zXVb70209NM4YL9Dslv",
            "match": false
        }
    ]

When calling the "getcelebritiesbyusertoken" the next json will be generated by the Twitter user

    [
        {
            "twitteraccount": "MileyCyrus",
            "name": "Miley Ray Cyrus",
            "urlphotoprofile": "http://pbs.twimg.com/profile_images/1172578079757062144/vG6TDFAh_normal.jpg",
            "id": "00ByuxVlET5mi7UdtIAt",
            "match": true
        },
        {
            "twitteraccount": "Cristiano",
            "name": "Cristiano Ronaldo",
            "urlphotoprofile": "http://pbs.twimg.com/profile_images/1157313327867092993/a09TxL_1_normal.jpg",
            "id": "0kOUeblGlR6aflMFAXQ5",
            "match": false
        },
        {
            "twitteraccount": "realDonaldTrump",
            "name": "Donald J. Trump",
            "urlphotoprofile": "http://pbs.twimg.com/profile_images/874276197357596672/kUuht00m_normal.jpg",
            "id": "4zXVb70209NM4YL9Dslv",
            "match": true
        }
    ]


## Testing
Tests can be run using, from the root of this repository:

    cd tests
    pipenv run pytest

Tests are made for these functions:

 - get_all_celebrities
 - get_celebrities_by_token
